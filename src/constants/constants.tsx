import { Badge } from "@/components/ui/badge";
import { Attack, Session, ThreatLocation } from "@/types";
import {
  ChartSpline,
  CircleAlert,
  LayoutDashboard,
  Power,
  Search,
  Settings,
  Shield,
  Activity,
  TrendingUp,
  Zap,
} from "lucide-react";

export const navigationTabs = (params: string) => [
  {
    id: 1,
    icon: <LayoutDashboard className="size-4.5 sm:size-6" />,
    label: "SOC Dashboard",
    href: `/?${params}`,
  },
  {
    id: 2,
    icon: <Search className="size-4.5 sm:size-6" />,
    label: "Investigation",
    href: `/investigation?${params}`,
  },
  {
    id: 3,
    icon: <ChartSpline className="size-4.5 sm:size-6" />,
    label: "Behavioral Analysis",
    href: `/analysis?${params}`,
  },
  {
    id: 4,
    icon: <CircleAlert className="size-4.5 sm:size-6" />,
    label: "Incidents",
    href: `/incidents?${params}`,
  },
  {
    id: 5,
    icon: <Power className="size-4.5 sm:size-6" />,
    label: "Performance",
    href: `/performance?${params}`,
  },
  {
    id: 6,
    icon: <Settings className="size-4.5 sm:size-6" />,
    label: "Configuration",
    href: `/configuration?${params}`,
  },
];

export const overviewData = (score: number) => {
  return [
    {
      label: "Risk Score",
      score: score,
      description: "out of 100",
      icon: Shield,
      isRisk: true,
    },
    {
      label: "Active Sessions",
      score: "1,247",
      description: "â†‘ 12% from avg",
      icon: Activity,
      iconColor: "#00D4FF",
    },
    {
      label: "Requests/sec",
      score: "9,842",
      description: "avg latency: 28ms",
      icon: Zap,
      iconColor: "#00C896",
    },
    {
      label: "False Positive Rate",
      score: "0.18%",
      description: "1.8 per 1000 req",
      icon: TrendingUp,
      iconColor: "#FFB800",
    },
  ];
};

export const threats: ThreatLocation[] = [
  { country: "United States", count: 145, lat: 37.0902, lng: -95.7129 },
  { country: "China", count: 234, lat: 35.8617, lng: 104.1954 },
  { country: "Russia", count: 187, lat: 61.524, lng: 105.3188 },
  { country: "Brazil", count: 98, lat: -14.235, lng: -51.9253 },
  { country: "India", count: 156, lat: 20.5937, lng: 78.9629 },
  { country: "Germany", count: 67, lat: 51.1657, lng: 10.4515 },
  { country: "France", count: 54, lat: 46.2276, lng: 2.2137 },
  { country: "United Kingdom", count: 78, lat: 55.3781, lng: -3.436 },
];

export const maxCount = Math.max(...threats.map((t) => t.count));

export const detectionData = [
  { name: "Session Behavior", value: 40, color: "#00D4FF" },
  { name: "Contract Validation", value: 30, color: "#00C896" },
  { name: "Attack Classification", value: 15, color: "#FFB800" },
  { name: "Mimic Guard", value: 5, color: "#FF3366" },
  { name: "Other", value: 10, color: "#8892B0" },
];

export const attackTypes = [
  { name: "SQL Injection", value: 45, color: "#FF3366" },
  { name: "XSS", value: 25, color: "#FFB800" },
  { name: "CSRF", value: 15, color: "#00D4FF" },
  { name: "Path Traversal", value: 10, color: "#00C896" },
  { name: "Other", value: 5, color: "#8892B0" },
];

export const chartData = [
  { date: "2024-04-01", totalRequests: 372, blocked: 72 },
  { date: "2024-04-02", totalRequests: 277, blocked: 47 },
  { date: "2024-04-03", totalRequests: 287, blocked: 87 },
  { date: "2024-04-04", totalRequests: 502, blocked: 102 },
  { date: "2024-04-05", totalRequests: 663, blocked: 163 },
  { date: "2024-04-06", totalRequests: 641, blocked: 141 },
  { date: "2024-04-07", totalRequests: 425, blocked: 125 },
  { date: "2024-04-08", totalRequests: 729, blocked: 229 },
  { date: "2024-04-09", totalRequests: 169, blocked: 69 },
  { date: "2024-04-10", totalRequests: 451, blocked: 151 },
  { date: "2024-04-11", totalRequests: 677, blocked: 177 },
  { date: "2024-04-12", totalRequests: 502, blocked: 102 },
  { date: "2024-04-13", totalRequests: 722, blocked: 222 },
  { date: "2024-04-14", totalRequests: 357, blocked: 57 },
  { date: "2024-04-15", totalRequests: 290, blocked: 90 },
  { date: "2024-04-16", totalRequests: 328, blocked: 128 },
  { date: "2024-04-17", totalRequests: 806, blocked: 206 },
  { date: "2024-04-18", totalRequests: 774, blocked: 174 },
  { date: "2024-04-19", totalRequests: 423, blocked: 123 },
  { date: "2024-04-20", totalRequests: 239, blocked: 39 },
  { date: "2024-04-21", totalRequests: 337, blocked: 137 },
  { date: "2024-04-22", totalRequests: 394, blocked: 94 },
  { date: "2024-04-23", totalRequests: 368, blocked: 68 },
  { date: "2024-04-24", totalRequests: 677, blocked: 177 },
  { date: "2024-04-25", totalRequests: 465, blocked: 165 },
  { date: "2024-04-26", totalRequests: 205, blocked: 105 },
  { date: "2024-04-27", totalRequests: 803, blocked: 203 },
  { date: "2024-04-28", totalRequests: 302, blocked: 102 },
  { date: "2024-04-29", totalRequests: 555, blocked: 155 },
  { date: "2024-04-30", totalRequests: 834, blocked: 234 },
  { date: "2024-05-01", totalRequests: 385, blocked: 85 },
  { date: "2024-05-02", totalRequests: 603, blocked: 103 },
  { date: "2024-05-03", totalRequests: 437, blocked: 137 },
  { date: "2024-05-04", totalRequests: 805, blocked: 205 },
  { date: "2024-05-05", totalRequests: 871, blocked: 171 },
  { date: "2024-05-06", totalRequests: 1018, blocked: 218 },
  { date: "2024-05-07", totalRequests: 688, blocked: 188 },
  { date: "2024-05-08", totalRequests: 359, blocked: 59 },
  { date: "2024-05-09", totalRequests: 407, blocked: 107 },
  { date: "2024-05-10", totalRequests: 623, blocked: 123 },
  { date: "2024-05-11", totalRequests: 605, blocked: 105 },
  { date: "2024-05-12", totalRequests: 437, blocked: 137 },
  { date: "2024-05-13", totalRequests: 357, blocked: 157 },
  { date: "2024-05-14", totalRequests: 938, blocked: 238 },
  { date: "2024-05-15", totalRequests: 853, blocked: 153 },
  { date: "2024-05-16", totalRequests: 738, blocked: 138 },
  { date: "2024-05-17", totalRequests: 919, blocked: 219 },
  { date: "2024-05-18", totalRequests: 665, blocked: 165 },
  { date: "2024-05-19", totalRequests: 415, blocked: 115 },
  { date: "2024-05-20", totalRequests: 407, blocked: 107 },
  { date: "2024-05-21", totalRequests: 222, blocked: 22 },
  { date: "2024-05-22", totalRequests: 201, blocked: 101 },
  { date: "2024-05-23", totalRequests: 542, blocked: 142 },
  { date: "2024-05-24", totalRequests: 514, blocked: 114 },
  { date: "2024-05-25", totalRequests: 451, blocked: 151 },
  { date: "2024-05-26", totalRequests: 383, blocked: 83 },
  { date: "2024-05-27", totalRequests: 880, blocked: 180 },
  { date: "2024-05-28", totalRequests: 423, blocked: 123 },
  { date: "2024-05-29", totalRequests: 208, blocked: 108 },
  { date: "2024-05-30", totalRequests: 620, blocked: 120 },
  { date: "2024-05-31", totalRequests: 408, blocked: 108 },
  { date: "2024-06-01", totalRequests: 378, blocked: 78 },
  { date: "2024-06-02", totalRequests: 880, blocked: 180 },
  { date: "2024-06-03", totalRequests: 263, blocked: 63 },
  { date: "2024-06-04", totalRequests: 819, blocked: 119 },
  { date: "2024-06-05", totalRequests: 228, blocked: 28 },
  { date: "2024-06-06", totalRequests: 544, blocked: 144 },
  { date: "2024-06-07", totalRequests: 693, blocked: 193 },
  { date: "2024-06-08", totalRequests: 705, blocked: 105 },
  { date: "2024-06-09", totalRequests: 918, blocked: 218 },
  { date: "2024-06-10", totalRequests: 355, blocked: 55 },
  { date: "2024-06-11", totalRequests: 242, blocked: 42 },
  { date: "2024-06-12", totalRequests: 912, blocked: 212 },
  { date: "2024-06-13", totalRequests: 211, blocked: 111 },
  { date: "2024-06-14", totalRequests: 806, blocked: 106 },
  { date: "2024-06-15", totalRequests: 657, blocked: 157 },
  { date: "2024-06-16", totalRequests: 681, blocked: 181 },
  { date: "2024-06-17", totalRequests: 995, blocked: 195 },
  { date: "2024-06-18", totalRequests: 277, blocked: 77 },
  { date: "2024-06-19", totalRequests: 631, blocked: 131 },
  { date: "2024-06-20", totalRequests: 858, blocked: 158 },
  { date: "2024-06-21", totalRequests: 379, blocked: 79 },
  { date: "2024-06-22", totalRequests: 587, blocked: 87 },
  { date: "2024-06-23", totalRequests: 1010, blocked: 210 },
  { date: "2024-06-24", totalRequests: 312, blocked: 112 },
  { date: "2024-06-25", totalRequests: 331, blocked: 131 },
  { date: "2024-06-26", totalRequests: 814, blocked: 214 },
  { date: "2024-06-27", totalRequests: 938, blocked: 138 },
  { date: "2024-06-28", totalRequests: 349, blocked: 149 },
  { date: "2024-06-29", totalRequests: 263, blocked: 63 },
  { date: "2024-06-30", totalRequests: 846, blocked: 246 },
];

export const mockAttacks: Attack[] = [
  {
    id: "ATK-2024-001",
    timestamp: "2024-11-01 14:32:15",
    ip: "192.168.1.105",
    country: "CN",
    type: "SQL Injection",
    severity: "critical",
    riskScore: 94,
    endpoint: "/api/users",
    status: "blocked",
  },
  {
    id: "ATK-2024-002",
    timestamp: "2024-11-01 14:28:43",
    ip: "10.0.0.45",
    country: "RU",
    type: "XSS",
    severity: "high",
    riskScore: 78,
    endpoint: "/api/search",
    status: "blocked",
  },
  {
    id: "ATK-2024-003",
    timestamp: "2024-11-01 14:25:12",
    ip: "172.16.0.88",
    country: "US",
    type: "CSRF",
    severity: "medium",
    riskScore: 65,
    endpoint: "/api/data",
    status: "challenged",
  },
  {
    id: "ATK-2024-004",
    timestamp: "2024-11-01 14:21:09",
    ip: "203.0.113.21",
    country: "IR",
    type: "Brute Force",
    severity: "high",
    riskScore: 81,
    endpoint: "/api/auth/login",
    status: "blocked",
  },
  {
    id: "ATK-2024-005",
    timestamp: "2024-11-01 14:17:55",
    ip: "198.51.100.73",
    country: "BR",
    type: "Credential Stuffing",
    severity: "critical",
    riskScore: 92,
    endpoint: "/api/auth/login",
    status: "blocked",
  },
  {
    id: "ATK-2024-006",
    timestamp: "2024-11-01 14:12:34",
    ip: "192.0.2.64",
    country: "DE",
    type: "Unauthorized API Access",
    severity: "high",
    riskScore: 74,
    endpoint: "/api/admin",
    status: "blocked",
  },
  {
    id: "ATK-2024-007",
    timestamp: "2024-11-01 14:08:19",
    ip: "172.16.1.33",
    country: "IN",
    type: "Malware Upload",
    severity: "medium",
    riskScore: 67,
    endpoint: "/api/upload",
    status: "challenged",
  },
  {
    id: "ATK-2024-008",
    timestamp: "2024-11-01 14:03:02",
    ip: "10.0.0.91",
    country: "FR",
    type: "Port Scanning",
    severity: "low",
    riskScore: 42,
    endpoint: "/",
    status: "allowed",
  },
  {
    id: "ATK-2024-009",
    timestamp: "2024-11-01 13:58:46",
    ip: "203.0.113.99",
    country: "KP",
    type: "DDoS",
    severity: "critical",
    riskScore: 96,
    endpoint: "/api/health",
    status: "blocked",
  },
  {
    id: "ATK-2024-010",
    timestamp: "2024-11-01 13:54:11",
    ip: "198.51.100.12",
    country: "GB",
    type: "Path Traversal",
    severity: "high",
    riskScore: 79,
    endpoint: "/api/files",
    status: "blocked",
  },
  {
    id: "ATK-2024-011",
    timestamp: "2024-11-01 13:49:22",
    ip: "203.0.113.45",
    country: "CN",
    type: "SQL Injection",
    severity: "critical",
    riskScore: 97,
    endpoint: "/api/products",
    status: "blocked",
  },
  {
    id: "ATK-2024-012",
    timestamp: "2024-11-01 13:45:38",
    ip: "192.168.2.101",
    country: "RU",
    type: "XSS",
    severity: "medium",
    riskScore: 62,
    endpoint: "/api/comments",
    status: "challenged",
  },
  {
    id: "ATK-2024-013",
    timestamp: "2024-11-01 13:41:15",
    ip: "10.1.1.77",
    country: "US",
    type: "Brute Force",
    severity: "high",
    riskScore: 83,
    endpoint: "/admin/login",
    status: "blocked",
  },
  {
    id: "ATK-2024-014",
    timestamp: "2024-11-01 13:37:49",
    ip: "172.31.0.12",
    country: "JP",
    type: "Credential Stuffing",
    severity: "medium",
    riskScore: 58,
    endpoint: "/api/user/login",
    status: "allowed",
  },
  {
    id: "ATK-2024-015",
    timestamp: "2024-11-01 13:33:27",
    ip: "198.18.0.155",
    country: "CA",
    type: "DDoS",
    severity: "critical",
    riskScore: 98,
    endpoint: "/",
    status: "blocked",
  },
  {
    id: "ATK-2024-016",
    timestamp: "2024-11-01 13:29:11",
    ip: "192.0.2.189",
    country: "KR",
    type: "Path Traversal",
    severity: "low",
    riskScore: 38,
    endpoint: "/api/download",
    status: "challenged",
  },
  {
    id: "ATK-2024-017",
    timestamp: "2024-11-01 13:25:03",
    ip: "203.0.113.67",
    country: "AU",
    type: "SQL Injection",
    severity: "high",
    riskScore: 76,
    endpoint: "/api/orders",
    status: "blocked",
  },
  {
    id: "ATK-2024-018",
    timestamp: "2024-11-01 13:20:47",
    ip: "10.10.10.25",
    country: "NL",
    type: "XSS",
    severity: "critical",
    riskScore: 91,
    endpoint: "/api/profile",
    status: "blocked",
  },
  {
    id: "ATK-2024-019",
    timestamp: "2024-11-01 13:16:32",
    ip: "172.20.1.42",
    country: "SG",
    type: "Brute Force",
    severity: "medium",
    riskScore: 55,
    endpoint: "/api/auth",
    status: "allowed",
  },
  {
    id: "ATK-2024-020",
    timestamp: "2024-11-01 13:12:19",
    ip: "198.51.100.204",
    country: "IT",
    type: "CSRF",
    severity: "high",
    riskScore: 73,
    endpoint: "/api/transfer",
    status: "blocked",
  },
  {
    id: "ATK-2024-021",
    timestamp: "2024-11-01 13:08:04",
    ip: "192.168.0.99",
    country: "MX",
    type: "Malware Upload",
    severity: "low",
    riskScore: 45,
    endpoint: "/api/attachments",
    status: "challenged",
  },
  {
    id: "ATK-2024-022",
    timestamp: "2024-11-01 13:03:51",
    ip: "203.0.113.88",
    country: "ZA",
    type: "Port Scanning",
    severity: "medium",
    riskScore: 60,
    endpoint: "/api",
    status: "blocked",
  },
  {
    id: "ATK-2024-023",
    timestamp: "2024-11-01 12:59:37",
    ip: "10.0.255.12",
    country: "SE",
    type: "Unauthorized API Access",
    severity: "critical",
    riskScore: 89,
    endpoint: "/api/config",
    status: "blocked",
  },
  {
    id: "ATK-2024-024",
    timestamp: "2024-11-01 12:55:22",
    ip: "172.16.254.1",
    country: "CH",
    type: "SQL Injection",
    severity: "medium",
    riskScore: 63,
    endpoint: "/api/customers",
    status: "challenged",
  },
  {
    id: "ATK-2024-025",
    timestamp: "2024-11-01 12:51:08",
    ip: "198.51.100.33",
    country: "TR",
    type: "DDoS",
    severity: "high",
    riskScore: 82,
    endpoint: "/api/status",
    status: "blocked",
  },
];

export const detectionLayers = [
  { layer: "Session Behavior", score: 92, weight: 40, contribution: 36.8 },
  { layer: "Contract Validation", score: 88, weight: 30, contribution: 26.4 },
  {
    layer: "Attack Classification",
    score: 95,
    weight: 15,
    contribution: 14.25,
  },
  { layer: "Mimic Guard", score: 78, weight: 5, contribution: 3.9 },
];

export const topFeatures = [
  { feature: "request_rate_spike", importance: 0.23 },
  { feature: "sql_pattern_match", importance: 0.19 },
  { feature: "param_anomaly_score", importance: 0.16 },
  { feature: "error_rate_increase", importance: 0.14 },
  { feature: "endpoint_deviation", importance: 0.12 },
  { feature: "payload_entropy", importance: 0.1 },
  { feature: "user_agent_anomaly", importance: 0.06 },
];

export const rawRequest = `POST /api/users HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Content-Type: application/json
Content-Length: 156

{
  "username": "admin' OR '1'='1",
  "password": "test123",
  "email": "test@example.com'; DROP TABLE users;--"
}`;

export const rawResponse = (selectedAttack: Attack) => {
  return `HTTP/1.1 403 Forbidden
Content-Type: application/json
X-BehavGuard-Action: blocked
X-BehavGuard-Risk-Score: 94
X-BehavGuard-Attack-Type: sql_injection

{
  "error": "Request blocked by BehavGuard",
  "reason": "Malicious SQL injection pattern detected",
  "request_id": "req_${selectedAttack.id}"
}`;
};

export const attackMeta = (selectedAttack: Attack) => {
  return [
    {
      label: "Risk Score",
      value: selectedAttack.riskScore,
      valueClass: "text-2xl text-[#FF3366]",
    },
    {
      label: "Attack Type",
      value: selectedAttack.type,
      valueClass: "text-sm",
    },
    {
      label: "Source IP",
      value: selectedAttack.ip,
      valueClass: "text-sm",
    },
    {
      label: "Status",
      value: (
        <Badge className="mt-1 bg-[#FF3366]">{selectedAttack.status}</Badge>
      ),
    },
  ];
};

export const tabs = [
  { value: "layers", label: "4-Layer Analysis" },
  { value: "features", label: "Feature Importance" },
  { value: "timeline", label: "Session Timeline" },
  { value: "raw", label: "Raw Data" },
];

export const sessions: Session[] = [
  {
    id: "SES-001",
    ip: "192.168.1.105",
    startTime: "14:30:12",
    duration: "2m 15s",
    requests: 156,
    anomalyScore: 94,
    status: "blocked",
  },
  {
    id: "SES-002",
    ip: "10.0.0.45",
    startTime: "14:28:43",
    duration: "1m 48s",
    requests: 89,
    anomalyScore: 78,
    status: "blocked",
  },
  {
    id: "SES-003",
    ip: "172.16.0.88",
    startTime: "14:25:12",
    duration: "3m 05s",
    requests: 124,
    anomalyScore: 65,
    status: "challenged",
  },
  {
    id: "SES-004",
    ip: "192.168.1.200",
    startTime: "14:22:30",
    duration: "5m 12s",
    requests: 45,
    anomalyScore: 12,
    status: "allowed",
  },
];

export const endpointData = [
  { endpoint: "/api/users", normal: 120, suspicious: 45, current: 165 },
  { endpoint: "/api/search", normal: 85, suspicious: 12, current: 97 },
  { endpoint: "/api/data", normal: 95, suspicious: 8, current: 103 },
  { endpoint: "/api/login", normal: 45, suspicious: 2, current: 47 },
  { endpoint: "/admin/dashboard", normal: 5, suspicious: 78, current: 83 },
  { endpoint: "/api/payments", normal: 35, suspicious: 3, current: 38 },
];
